!function(e,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.WOW=n.exports}}(this,function(e,t){"use strict";var n,i;function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e};function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t){return 0<=t.indexOf(e)}function r(e,t,n){null!=e.addEventListener?e.addEventListener(t,n,!1):null!=e.attachEvent?e.attachEvent("on"+t,n):e[t]=n}function c(e,t,n){null!=e.removeEventListener?e.removeEventListener(t,n,!1):null!=e.detachEvent?e.detachEvent("on"+t,n):delete e[t]}var u=window.WeakMap||window.MozWeakMap||(s(h,[{key:"get",value:function(e){for(var t=0;t<this.keys.length;t++)if(this.keys[t]===e)return this.values[t]}},{key:"set",value:function(e,t){for(var n=0;n<this.keys.length;n++)if(this.keys[n]===e)return this.values[n]=t,this;return this.keys.push(e),this.values.push(t),this}}]),h);function h(){o(this,h),this.keys=[],this.values=[]}var d=window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver||(s(f,[{key:"observe",value:function(){}}]),i=n=f,n.notSupported=!0,i);function f(){o(this,f),"undefined"!=typeof console&&null!==console&&(console.warn("MutationObserver is not supported by your browser."),console.warn("WOW.js cannot detect dom mutations, please call .sync() after loading new content."))}var v=window.getComputedStyle||function(n){var i=/(\-([a-z]){1})/g;return{getPropertyValue:function(e){"float"===e&&(e="styleFloat"),i.test(e)&&e.replace(i,function(e,t){return t.toUpperCase()});var t=n.currentStyle;return(null!=t?t[e]:void 0)||null}}},m=(s(y,[{key:"init",value:function(){this.element=window.document.documentElement,l(document.readyState,["interactive","complete"])?this.start():r(document,"DOMContentLoaded",this.start),this.finished=[]}},{key:"start",value:function(){var s=this;if(this.stopped=!1,this.boxes=[].slice.call(this.element.querySelectorAll("."+this.config.boxClass)),this.all=this.boxes.slice(0),this.boxes.length)if(this.disabled())this.resetStyle();else for(var e=0;e<this.boxes.length;e++){var t=this.boxes[e];this.applyStyle(t,!0)}this.disabled()||(r(this.config.scrollContainer||window,"scroll",this.scrollHandler),r(window,"resize",this.scrollHandler),this.interval=setInterval(this.scrollCallback,50)),this.config.live&&new d(function(e){for(var t=0;t<e.length;t++)for(var n=e[t],i=0;i<n.addedNodes.length;i++){var o=n.addedNodes[i];s.doSync(o)}}).observe(document.body,{childList:!0,subtree:!0})}},{key:"stop",value:function(){this.stopped=!0,c(this.config.scrollContainer||window,"scroll",this.scrollHandler),c(window,"resize",this.scrollHandler),null!=this.interval&&clearInterval(this.interval)}},{key:"sync",value:function(){d.notSupported&&this.doSync(this.element)}},{key:"doSync",value:function(e){if(null==e&&(e=this.element),1===e.nodeType)for(var t=(e=e.parentNode||e).querySelectorAll("."+this.config.boxClass),n=0;n<t.length;n++){var i=t[n];l(i,this.all)||(this.boxes.push(i),this.all.push(i),this.stopped||this.disabled()?this.resetStyle():this.applyStyle(i,!0),this.scrolled=!0)}}},{key:"show",value:function(e){return this.applyStyle(e),e.className=e.className+" "+this.config.animateClass,null!=this.config.callback&&this.config.callback(e),function(e,t){null!=e.dispatchEvent?e.dispatchEvent(t):t in(null!=e)?e[t]():"on"+t in(null!=e)&&e["on"+t]()}(e,this.wowEvent),r(e,"animationend",this.resetAnimation),r(e,"oanimationend",this.resetAnimation),r(e,"webkitAnimationEnd",this.resetAnimation),r(e,"MSAnimationEnd",this.resetAnimation),e}},{key:"applyStyle",value:function(e,t){var n=this,i=e.getAttribute("data-wow-duration"),o=e.getAttribute("data-wow-delay"),s=e.getAttribute("data-wow-iteration");return this.animate(function(){return n.customStyle(e,t,i,o,s)})}},{key:"resetStyle",value:function(){for(var e=0;e<this.boxes.length;e++)this.boxes[e].style.visibility="visible"}},{key:"resetAnimation",value:function(e){if(0<=e.type.toLowerCase().indexOf("animationend")){var t=e.target||e.srcElement;t.className=t.className.replace(this.config.animateClass,"").trim()}}},{key:"customStyle",value:function(e,t,n,i,o){return t&&this.cacheAnimationName(e),e.style.visibility=t?"hidden":"visible",n&&this.vendorSet(e.style,{animationDuration:n}),i&&this.vendorSet(e.style,{animationDelay:i}),o&&this.vendorSet(e.style,{animationIterationCount:o}),this.vendorSet(e.style,{animationName:t?"none":this.cachedAnimationName(e)}),e}},{key:"vendorSet",value:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];e[""+n]=i;for(var o=0;o<this.vendors.length;o++)e[""+this.vendors[o]+n.charAt(0).toUpperCase()+n.substr(1)]=i}}},{key:"vendorCSS",value:function(e,t){for(var n=v(e),i=n.getPropertyCSSValue(t),o=0;o<this.vendors.length;o++){var s=this.vendors[o];i=i||n.getPropertyCSSValue("-"+s+"-"+t)}return i}},{key:"animationName",value:function(t){var n=void 0;try{n=this.vendorCSS(t,"animation-name").cssText}catch(e){n=v(t).getPropertyValue("animation-name")}return"none"===n?"":n}},{key:"cacheAnimationName",value:function(e){return this.animationNameCache.set(e,this.animationName(e))}},{key:"cachedAnimationName",value:function(e){return this.animationNameCache.get(e)}},{key:"scrollHandler",value:function(){this.scrolled=!0}},{key:"scrollCallback",value:function(){if(this.scrolled){this.scrolled=!1;for(var e=[],t=0;t<this.boxes.length;t++){var n=this.boxes[t];if(n){if(this.isVisible(n)){this.show(n);continue}e.push(n)}}this.boxes=e,this.boxes.length||this.config.live||this.stop()}}},{key:"offsetTop",value:function(e){for(;void 0===e.offsetTop;)e=e.parentNode;for(var t=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}},{key:"isVisible",value:function(e){var t=e.getAttribute("data-wow-offset")||this.config.offset,n=this.config.scrollContainer&&this.config.scrollContainer.scrollTop||window.pageYOffset,i=n+Math.min(this.element.clientHeight,"innerHeight"in window?window.innerHeight:document.documentElement.clientHeight)-t,o=this.offsetTop(e),s=o+e.clientHeight;return o<=i&&n<=s}},{key:"disabled",value:function(){return!this.config.mobile&&function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}(navigator.userAgent)}}]),y);function y(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,y),this.defaults={boxClass:"wow",animateClass:"animated",offset:0,mobile:!0,live:!0,callback:null,scrollContainer:null},this.animate="requestAnimationFrame"in window?function(e){return window.requestAnimationFrame(e)}:function(e){return e()},this.vendors=["moz","webkit"],this.start=this.start.bind(this),this.resetAnimation=this.resetAnimation.bind(this),this.scrollHandler=this.scrollHandler.bind(this),this.scrollCallback=this.scrollCallback.bind(this),this.scrolled=!0,this.config=function(e,t){for(var n in t)if(null==e[n]){var i=t[n];e[n]=i}return e}(e,this.defaults),null!=e.scrollContainer&&(this.config.scrollContainer=document.querySelector(e.scrollContainer)),this.animationNameCache=new u,this.wowEvent=function(e,t,n,i){var o=!(arguments.length<=1||void 0===t)&&t,s=!(arguments.length<=2||void 0===n)&&n,a=arguments.length<=3||void 0===i?null:i,l=void 0;return null!=document.createEvent?(l=document.createEvent("CustomEvent")).initCustomEvent(e,o,s,a):null!=document.createEventObject?(l=document.createEventObject()).eventType=e:l.eventName=e,l}(this.config.boxClass)}t.default=m,e.exports=t.default});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYnMvd293LmpzIl0sIm5hbWVzIjpbImdsb2JhbCIsImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCJleHBvcnRzIiwibW9kdWxlIiwibW9kIiwiV09XIiwidGhpcyIsIl9jbGFzcyIsIl90ZW1wIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfY3JlYXRlQ2xhc3MiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJkZWZpbmVQcm9wZXJ0aWVzIiwicHJvdG90eXBlIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImtleSIsImlzSW4iLCJuZWVkbGUiLCJoYXlzdGFjayIsImluZGV4T2YiLCJhZGRFdmVudCIsImVsZW0iLCJldmVudCIsImZuIiwiYWRkRXZlbnRMaXN0ZW5lciIsImF0dGFjaEV2ZW50IiwicmVtb3ZlRXZlbnQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZGV0YWNoRXZlbnQiLCJXZWFrTWFwIiwid2luZG93IiwiTW96V2Vha01hcCIsImtleXMiLCJ2YWx1ZXMiLCJwdXNoIiwiTXV0YXRpb25PYnNlcnZlciIsIldlYmtpdE11dGF0aW9uT2JzZXJ2ZXIiLCJNb3pNdXRhdGlvbk9ic2VydmVyIiwibm90U3VwcG9ydGVkIiwiY29uc29sZSIsIndhcm4iLCJnZXRDb21wdXRlZFN0eWxlIiwiZWwiLCJnZXRDb21wdXRlZFN0eWxlUlgiLCJnZXRQcm9wZXJ0eVZhbHVlIiwicHJvcCIsInRlc3QiLCJyZXBsYWNlIiwiXyIsIl9jaGFyIiwidG9VcHBlckNhc2UiLCJjdXJyZW50U3R5bGUiLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJyZWFkeVN0YXRlIiwic3RhcnQiLCJmaW5pc2hlZCIsIl90aGlzIiwic3RvcHBlZCIsImJveGVzIiwic2xpY2UiLCJjYWxsIiwicXVlcnlTZWxlY3RvckFsbCIsImNvbmZpZyIsImJveENsYXNzIiwiYWxsIiwiZGlzYWJsZWQiLCJyZXNldFN0eWxlIiwiYm94IiwiYXBwbHlTdHlsZSIsInNjcm9sbENvbnRhaW5lciIsInNjcm9sbEhhbmRsZXIiLCJpbnRlcnZhbCIsInNldEludGVydmFsIiwic2Nyb2xsQ2FsbGJhY2siLCJsaXZlIiwicmVjb3JkcyIsImoiLCJyZWNvcmQiLCJrIiwiYWRkZWROb2RlcyIsIm5vZGUiLCJkb1N5bmMiLCJvYnNlcnZlIiwiYm9keSIsImNoaWxkTGlzdCIsInN1YnRyZWUiLCJjbGVhckludGVydmFsIiwibm9kZVR5cGUiLCJpdGVyYWJsZSIsInBhcmVudE5vZGUiLCJzY3JvbGxlZCIsImNsYXNzTmFtZSIsImFuaW1hdGVDbGFzcyIsImNhbGxiYWNrIiwiZGlzcGF0Y2hFdmVudCIsImVtaXRFdmVudCIsIndvd0V2ZW50IiwicmVzZXRBbmltYXRpb24iLCJoaWRkZW4iLCJfdGhpczIiLCJkdXJhdGlvbiIsImdldEF0dHJpYnV0ZSIsImRlbGF5IiwiaXRlcmF0aW9uIiwiYW5pbWF0ZSIsImN1c3RvbVN0eWxlIiwic3R5bGUiLCJ2aXNpYmlsaXR5IiwidHlwZSIsInRvTG93ZXJDYXNlIiwic3JjRWxlbWVudCIsInRyaW0iLCJjYWNoZUFuaW1hdGlvbk5hbWUiLCJ2ZW5kb3JTZXQiLCJhbmltYXRpb25EdXJhdGlvbiIsImFuaW1hdGlvbkRlbGF5IiwiYW5pbWF0aW9uSXRlcmF0aW9uQ291bnQiLCJhbmltYXRpb25OYW1lIiwiY2FjaGVkQW5pbWF0aW9uTmFtZSIsInByb3BlcnRpZXMiLCJuYW1lIiwiaGFzT3duUHJvcGVydHkiLCJ2ZW5kb3JzIiwiY2hhckF0Iiwic3Vic3RyIiwicHJvcGVydHkiLCJyZXN1bHQiLCJnZXRQcm9wZXJ0eUNTU1ZhbHVlIiwidmVuZG9yIiwiYU5hbWUiLCJ2ZW5kb3JDU1MiLCJjc3NUZXh0IiwiZXJyb3IiLCJhbmltYXRpb25OYW1lQ2FjaGUiLCJzZXQiLCJnZXQiLCJyZXN1bHRzIiwiaXNWaXNpYmxlIiwic2hvdyIsInN0b3AiLCJ1bmRlZmluZWQiLCJvZmZzZXRUb3AiLCJ0b3AiLCJvZmZzZXRQYXJlbnQiLCJvZmZzZXQiLCJ2aWV3VG9wIiwic2Nyb2xsVG9wIiwicGFnZVlPZmZzZXQiLCJ2aWV3Qm90dG9tIiwiTWF0aCIsIm1pbiIsImNsaWVudEhlaWdodCIsImlubmVySGVpZ2h0IiwiYm90dG9tIiwibW9iaWxlIiwiYWdlbnQiLCJpc01vYmlsZSIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsIm9wdGlvbnMiLCJhcmd1bWVudHMiLCJkZWZhdWx0cyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImJpbmQiLCJjdXN0b20iLCJleHRlbmQiLCJxdWVyeVNlbGVjdG9yIiwiYnViYmxlIiwiY2FuY2VsIiwiZGV0YWlsIiwiY3VzdG9tRXZlbnQiLCJjcmVhdGVFdmVudCIsImluaXRDdXN0b21FdmVudCIsImNyZWF0ZUV2ZW50T2JqZWN0IiwiZXZlbnRUeXBlIiwiZXZlbnROYW1lIiwiZGVmYXVsdCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBV0EsRUFBUUMsR0FDakIsR0FBc0IsbUJBQVhDLFFBQXlCQSxPQUFPQyxJQUN6Q0QsT0FBTyxDQUFDLFNBQVUsV0FBWUQsUUFDekIsR0FBdUIsb0JBQVpHLFFBQ2hCSCxFQUFRSSxPQUFRRCxhQUNYLENBQ0wsSUFBSUUsRUFBTSxDQUNSRixRQUFTLElBRVhILEVBQVFLLEVBQUtBLEVBQUlGLFNBQ2pCSixFQUFPTyxJQUFNRCxFQUFJRixTQVZyQixDQVlHSSxLQUFNLFNBQVVILEVBQVFELEdBQ3pCLGFBTUEsSUFBSUssRUFBUUMsRUFFWixTQUFTQyxFQUFnQkMsRUFBVUMsR0FDakMsS0FBTUQsYUFBb0JDLEdBQ3hCLE1BQU0sSUFBSUMsVUFBVSxxQ0FSeEJDLE9BQU9DLGVBQWVaLEVBQVMsYUFBYyxDQUMzQ2EsT0FBTyxJQVdULElBQUlDLEVBV0ssU0FBVUwsRUFBYU0sRUFBWUMsR0FHeEMs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TUFBZkcsRUFBT3ZKLEdBQWMsQ0FDdkIsSUFBSWQsRUFBUWtLLEVBQVNwSixHQUNyQnVKLEVBQU92SixHQUFPZCxFQUdsQixPQUFPcUssRUEwTFNDLENBQU9OLEVBQVN6SyxLQUFLMkssVUFDSixNQUEzQkYsRUFBUTFGLGtCQUNWL0UsS0FBS3dFLE9BQU9PLGdCQUFrQmxCLFNBQVNtSCxjQUFjUCxFQUFRMUYsa0JBRy9EL0UsS0FBSytJLG1CQUFxQixJQUFJMUcsRUFDOUJyQyxLQUFLMEcsU0F4TFQsU0FBcUI1RSxFQUFyQixFQUFBLEVBQUEsR0FDRSxJQUFJbUosSUFBU1AsVUFBVXhKLFFBQVUsUUFBc0JvSSxJQUR6RCxJQUFBLEVBRU00QixJQUFTUixVQUFVeEosUUFBVSxRQUFzQm9JLElBRnpELElBQUEsRUFHTTZCLEVBQVNULFVBQVV4SixRQUFVLFFBQXNCb0ksSUFIekQsRUFHcUUsS0FIckUsRUFLTThCLE9BQWMsRUFhbEIsT0FaNEIsTUFBeEJ2SCxTQUFTd0gsYUFFWEQsRUFBY3ZILFNBQVN3SCxZQUFZLGdCQUN2QkMsZ0JBQWdCeEosRUFBT21KLEVBQVFDLEVBQVFDLEdBQ1osTUFBOUJ0SCxTQUFTMEgsbUJBRWxCSCxFQUFjdkgsU0FBUzBILHFCQUNYQyxVQUFZMUosRUFFeEJzSixFQUFZSyxVQUFZM0osRUFHbkJzSixFQXNLV0MsQ0FBWXJMLEtBQUt3RSxPQUFPQyxVQTBSNUM3RSxFQUFROEwsUUFBVTNMLEVBQ2xCRixFQUFPRCxRQUFVQSxFQUFpQiIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XHJcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7XHJcbiAgICBkZWZpbmUoWydtb2R1bGUnLCAnZXhwb3J0cyddLCBmYWN0b3J5KTtcclxuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICBmYWN0b3J5KG1vZHVsZSwgZXhwb3J0cyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHZhciBtb2QgPSB7XHJcbiAgICAgIGV4cG9ydHM6IHt9XHJcbiAgICB9O1xyXG4gICAgZmFjdG9yeShtb2QsIG1vZC5leHBvcnRzKTtcclxuICAgIGdsb2JhbC5XT1cgPSBtb2QuZXhwb3J0cztcclxuICB9XHJcbn0pKHRoaXMsIGZ1bmN0aW9uIChtb2R1bGUsIGV4cG9ydHMpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xyXG4gICAgdmFsdWU6IHRydWVcclxuICB9KTtcclxuXHJcbiAgdmFyIF9jbGFzcywgX3RlbXA7XHJcblxyXG4gIGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcclxuICAgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XHJcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xyXG4gICAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcclxuICAgICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XHJcbiAgICAgICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xyXG4gICAgICBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xyXG4gICAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcclxuICAgICAgcmV0dXJuIENvbnN0cnVjdG9yO1xyXG4gICAgfTtcclxuICB9KCk7XHJcblxyXG4gIGZ1bmN0aW9uIGlzSW4obmVlZGxlLCBoYXlzdGFjaykge1xyXG4gICAgcmV0dXJuIGhheXN0YWNrLmluZGV4T2YobmVlZGxlKSA+PSAwO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZXh0ZW5kKGN1c3RvbSwgZGVmYXVsdHMpIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBkZWZhdWx0cykge1xyXG4gICAgICBpZiAoY3VzdG9tW2tleV0gPT0gbnVsbCkge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IGRlZmF1bHRzW2tleV07XHJcbiAgICAgICAgY3VzdG9tW2tleV0gPSB2YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGN1c3RvbTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGlzTW9iaWxlKGFnZW50KSB7XHJcbiAgICByZXR1cm4gKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChhZ2VudClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVFdmVudChldmVudCkge1xyXG4gICAgdmFyIGJ1YmJsZSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzFdO1xyXG4gICAgdmFyIGNhbmNlbCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzJdO1xyXG4gICAgdmFyIGRldGFpbCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMyB8fCBhcmd1bWVudHNbM10gPT09IHVuZGVmaW5lZCA/IG51bGwgOiBhcmd1bWVudHNbM107XHJcblxyXG4gICAgdmFyIGN1c3RvbUV2ZW50ID0gdm9pZCAwO1xyXG4gICAgaWYgKGRvY3VtZW50LmNyZWF0ZUV2ZW50ICE9IG51bGwpIHtcclxuICAgICAgLy8gVzNDIERPTVxyXG4gICAgICBjdXN0b21FdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xyXG4gICAgICBjdXN0b21FdmVudC5pbml0Q3VzdG9tRXZlbnQoZXZlbnQsIGJ1YmJsZSwgY2FuY2VsLCBkZXRhaWwpO1xyXG4gICAgfSBlbHNlIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCAhPSBudWxsKSB7XHJcbiAgICAgIC8vIElFIERPTSA8IDlcclxuICAgICAgY3VzdG9tRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpO1xyXG4gICAgICBjdXN0b21FdmVudC5ldmVudFR5cGUgPSBldmVudDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGN1c3RvbUV2ZW50LmV2ZW50TmFtZSA9IGV2ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjdXN0b21FdmVudDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGVtaXRFdmVudChlbGVtLCBldmVudCkge1xyXG4gICAgaWYgKGVsZW0uZGlzcGF0Y2hFdmVudCAhPSBudWxsKSB7XHJcbiAgICAgIC8vIFczQyBET01cclxuICAgICAgZWxlbS5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgIH0gZWxzZSBpZiAoZXZlbnQgaW4gKGVsZW0gIT0gbnVsbCkpIHtcclxuICAgICAgZWxlbVtldmVudF0oKTtcclxuICAgIH0gZWxzZSBpZiAoJ29uJyArIGV2ZW50IGluIChlbGVtICE9IG51bGwpKSB7XHJcbiAgICAgIGVsZW1bJ29uJyArIGV2ZW50XSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gYWRkRXZlbnQoZWxlbSwgZXZlbnQsIGZuKSB7XHJcbiAgICBpZiAoZWxlbS5hZGRFdmVudExpc3RlbmVyICE9IG51bGwpIHtcclxuICAgICAgLy8gVzNDIERPTVxyXG4gICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGZuLCBmYWxzZSk7XHJcbiAgICB9IGVsc2UgaWYgKGVsZW0uYXR0YWNoRXZlbnQgIT0gbnVsbCkge1xyXG4gICAgICAvLyBJRSBET01cclxuICAgICAgZWxlbS5hdHRhY2hFdmVudCgnb24nICsgZXZlbnQsIGZuKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIGZhbGxiYWNrXHJcbiAgICAgIGVsZW1bZXZlbnRdID0gZm47XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZW1vdmVFdmVudChlbGVtLCBldmVudCwgZm4pIHtcclxuICAgIGlmIChlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIgIT0gbnVsbCkge1xyXG4gICAgICAvLyBXM0MgRE9NXHJcbiAgICAgIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgZm4sIGZhbHNlKTtcclxuICAgIH0gZWxzZSBpZiAoZWxlbS5kZXRhY2hFdmVudCAhPSBudWxsKSB7XHJcbiAgICAgIC8vIElFIERPTVxyXG4gICAgICBlbGVtLmRldGFjaEV2ZW50KCdvbicgKyBldmVudCwgZm4pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gZmFsbGJhY2tcclxuICAgICAgZGVsZXRlIGVsZW1bZXZlbnRdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0SW5uZXJIZWlnaHQoKSB7XHJcbiAgICBpZiAoJ2lubmVySGVpZ2h0JyBpbiB3aW5kb3cpIHtcclxuICAgICAgcmV0dXJuIHdpbmRvdy5pbm5lckhlaWdodDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcclxuICB9XHJcblxyXG4gIC8vIE1pbmltYWxpc3RpYyBXZWFrTWFwIHNoaW0sIGp1c3QgaW4gY2FzZS5cclxuICB2YXIgV2Vha01hcCA9IHdpbmRvdy5XZWFrTWFwIHx8IHdpbmRvdy5Nb3pXZWFrTWFwIHx8IGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdlYWtNYXAoKSB7XHJcbiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXZWFrTWFwKTtcclxuXHJcbiAgICAgIHRoaXMua2V5cyA9IFtdO1xyXG4gICAgICB0aGlzLnZhbHVlcyA9IFtdO1xyXG4gICAgfVxyXG5cclxuICAgIF9jcmVhdGVDbGFzcyhXZWFrTWFwLCBbe1xyXG4gICAgICBrZXk6ICdnZXQnLFxyXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0KGtleSkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5rZXlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMua2V5c1tpXTtcclxuICAgICAgICAgIGlmIChpdGVtID09PSBrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVzW2ldO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICB9XHJcbiAgICB9LCB7XHJcbiAgICAgIGtleTogJ3NldCcsXHJcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXQoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5rZXlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMua2V5c1tpXTtcclxuICAgICAgICAgIGlmIChpdGVtID09PSBrZXkpIHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZXNbaV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMua2V5cy5wdXNoKGtleSk7XHJcbiAgICAgICAgdGhpcy52YWx1ZXMucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgIH1cclxuICAgIH1dKTtcclxuXHJcbiAgICByZXR1cm4gV2Vha01hcDtcclxuICB9KCk7XHJcblxyXG4gIC8vIER1bW15IE11dGF0aW9uT2JzZXJ2ZXIsIHRvIGF2b2lkIHJhaXNpbmcgZXhjZXB0aW9ucy5cclxuICB2YXIgTXV0YXRpb25PYnNlcnZlciA9IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5XZWJraXRNdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5Nb3pNdXRhdGlvbk9ic2VydmVyIHx8IChfdGVtcCA9IF9jbGFzcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE11dGF0aW9uT2JzZXJ2ZXIoKSB7XHJcbiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNdXRhdGlvbk9ic2VydmVyKTtcclxuXHJcbiAgICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYgY29uc29sZSAhPT0gbnVsbCkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybignTXV0YXRpb25PYnNlcnZlciBpcyBub3Qgc3VwcG9ydGVkIGJ5IHlvdXIgYnJvd3Nlci4nKTtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ1dPVy5qcyBjYW5ub3QgZGV0ZWN0IGRvbSBtdXRhdGlvbnMsIHBsZWFzZSBjYWxsIC5zeW5jKCkgYWZ0ZXIgbG9hZGluZyBuZXcgY29udGVudC4nKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9jcmVhdGVDbGFzcyhNdXRhdGlvbk9ic2VydmVyLCBbe1xyXG4gICAgICBrZXk6ICdvYnNlcnZlJyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoKSB7fVxyXG4gICAgfV0pO1xyXG5cclxuICAgIHJldHVybiBNdXRhdGlvbk9ic2VydmVyO1xyXG4gIH0oKSwgX2NsYXNzLm5vdFN1cHBvcnRlZCA9IHRydWUsIF90ZW1wKTtcclxuXHJcbiAgLy8gZ2V0Q29tcHV0ZWRTdHlsZSBzaGltLCBmcm9tIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIxNzk3Mjk0XHJcbiAgdmFyIGdldENvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSB8fCBmdW5jdGlvbiBnZXRDb21wdXRlZFN0eWxlKGVsKSB7XHJcbiAgICB2YXIgZ2V0Q29tcHV0ZWRTdHlsZVJYID0gLyhcXC0oW2Etel0pezF9KS9nO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZ2V0UHJvcGVydHlWYWx1ZTogZnVuY3Rpb24gZ2V0UHJvcGVydHlWYWx1ZShwcm9wKSB7XHJcbiAgICAgICAgaWYgKHByb3AgPT09ICdmbG9hdCcpIHtcclxuICAgICAgICAgIHByb3AgPSAnc3R5bGVGbG9hdCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlUlgudGVzdChwcm9wKSkge1xyXG4gICAgICAgICAgcHJvcC5yZXBsYWNlKGdldENvbXB1dGVkU3R5bGVSWCwgZnVuY3Rpb24gKF8sIF9jaGFyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfY2hhci50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjdXJyZW50U3R5bGUgPSBlbC5jdXJyZW50U3R5bGU7XHJcblxyXG4gICAgICAgIHJldHVybiAoY3VycmVudFN0eWxlICE9IG51bGwgPyBjdXJyZW50U3R5bGVbcHJvcF0gOiB2b2lkIDApIHx8IG51bGw7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfTtcclxuXHJcbiAgdmFyIFdPVyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdPVygpIHtcclxuICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1swXTtcclxuXHJcbiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXT1cpO1xyXG5cclxuICAgICAgdGhpcy5kZWZhdWx0cyA9IHtcclxuICAgICAgICBib3hDbGFzczogJ3dvdycsXHJcbiAgICAgICAgYW5pbWF0ZUNsYXNzOiAnYW5pbWF0ZWQnLFxyXG4gICAgICAgIG9mZnNldDogMCxcclxuICAgICAgICBtb2JpbGU6IHRydWUsXHJcbiAgICAgICAgbGl2ZTogdHJ1ZSxcclxuICAgICAgICBjYWxsYmFjazogbnVsbCxcclxuICAgICAgICBzY3JvbGxDb250YWluZXI6IG51bGxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHRoaXMuYW5pbWF0ZSA9IGZ1bmN0aW9uIGFuaW1hdGVGYWN0b3J5KCkge1xyXG4gICAgICAgIGlmICgncmVxdWVzdEFuaW1hdGlvbkZyYW1lJyBpbiB3aW5kb3cpIHtcclxuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2FsbGJhY2spO1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSgpO1xyXG5cclxuICAgICAgdGhpcy52ZW5kb3JzID0gWydtb3onLCAnd2Via2l0J107XHJcblxyXG4gICAgICB0aGlzLnN0YXJ0ID0gdGhpcy5zdGFydC5iaW5kKHRoaXMpO1xyXG4gICAgICB0aGlzLnJlc2V0QW5pbWF0aW9uID0gdGhpcy5yZXNldEFuaW1hdGlvbi5iaW5kKHRoaXMpO1xyXG4gICAgICB0aGlzLnNjcm9sbEhhbmRsZXIgPSB0aGlzLnNjcm9sbEhhbmRsZXIuYmluZCh0aGlzKTtcclxuICAgICAgdGhpcy5zY3JvbGxDYWxsYmFjayA9IHRoaXMuc2Nyb2xsQ2FsbGJhY2suYmluZCh0aGlzKTtcclxuICAgICAgdGhpcy5zY3JvbGxlZCA9IHRydWU7XHJcbiAgICAgIHRoaXMuY29uZmlnID0gZXh0ZW5kKG9wdGlvbnMsIHRoaXMuZGVmYXVsdHMpO1xyXG4gICAgICBpZiAob3B0aW9ucy5zY3JvbGxDb250YWluZXIgIT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMuY29uZmlnLnNjcm9sbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9ucy5zY3JvbGxDb250YWluZXIpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIE1hcCBvZiBlbGVtZW50cyB0byBhbmltYXRpb24gbmFtZXM6XHJcbiAgICAgIHRoaXMuYW5pbWF0aW9uTmFtZUNhY2hlID0gbmV3IFdlYWtNYXAoKTtcclxuICAgICAgdGhpcy53b3dFdmVudCA9IGNyZWF0ZUV2ZW50KHRoaXMuY29uZmlnLmJveENsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfY3JlYXRlQ2xhc3MoV09XLCBbe1xyXG4gICAgICBrZXk6ICdpbml0JyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcclxuICAgICAgICBpZiAoaXNJbihkb2N1bWVudC5yZWFkeVN0YXRlLCBbJ2ludGVyYWN0aXZlJywgJ2NvbXBsZXRlJ10pKSB7XHJcbiAgICAgICAgICB0aGlzLnN0YXJ0KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGFkZEV2ZW50KGRvY3VtZW50LCAnRE9NQ29udGVudExvYWRlZCcsIHRoaXMuc3RhcnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmZpbmlzaGVkID0gW107XHJcbiAgICAgIH1cclxuICAgIH0sIHtcclxuICAgICAga2V5OiAnc3RhcnQnLFxyXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnQoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuXHJcbiAgICAgICAgdGhpcy5zdG9wcGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5ib3hlcyA9IFtdLnNsaWNlLmNhbGwodGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgdGhpcy5jb25maWcuYm94Q2xhc3MpKTtcclxuICAgICAgICB0aGlzLmFsbCA9IHRoaXMuYm94ZXMuc2xpY2UoMCk7XHJcbiAgICAgICAgaWYgKHRoaXMuYm94ZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXRTdHlsZSgpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmJveGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGJveCA9IHRoaXMuYm94ZXNbaV07XHJcbiAgICAgICAgICAgICAgdGhpcy5hcHBseVN0eWxlKGJveCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKCkpIHtcclxuICAgICAgICAgIGFkZEV2ZW50KHRoaXMuY29uZmlnLnNjcm9sbENvbnRhaW5lciB8fCB3aW5kb3csICdzY3JvbGwnLCB0aGlzLnNjcm9sbEhhbmRsZXIpO1xyXG4gICAgICAgICAgYWRkRXZlbnQod2luZG93LCAncmVzaXplJywgdGhpcy5zY3JvbGxIYW5kbGVyKTtcclxuICAgICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCh0aGlzLnNjcm9sbENhbGxiYWNrLCA1MCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5saXZlKSB7XHJcbiAgICAgICAgICB2YXIgbXV0ID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKHJlY29yZHMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByZWNvcmRzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHJlY29yZCA9IHJlY29yZHNbal07XHJcbiAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCByZWNvcmQuYWRkZWROb2Rlcy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSByZWNvcmQuYWRkZWROb2Rlc1trXTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmRvU3luYyhub2RlKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgbXV0Lm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xyXG4gICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXHJcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWVcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSwge1xyXG4gICAgICBrZXk6ICdzdG9wJyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7XHJcbiAgICAgICAgdGhpcy5zdG9wcGVkID0gdHJ1ZTtcclxuICAgICAgICByZW1vdmVFdmVudCh0aGlzLmNvbmZpZy5zY3JvbGxDb250YWluZXIgfHwgd2luZG93LCAnc2Nyb2xsJywgdGhpcy5zY3JvbGxIYW5kbGVyKTtcclxuICAgICAgICByZW1vdmVFdmVudCh3aW5kb3csICdyZXNpemUnLCB0aGlzLnNjcm9sbEhhbmRsZXIpO1xyXG4gICAgICAgIGlmICh0aGlzLmludGVydmFsICE9IG51bGwpIHtcclxuICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LCB7XHJcbiAgICAgIGtleTogJ3N5bmMnLFxyXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gc3luYygpIHtcclxuICAgICAgICBpZiAoTXV0YXRpb25PYnNlcnZlci5ub3RTdXBwb3J0ZWQpIHtcclxuICAgICAgICAgIHRoaXMuZG9TeW5jKHRoaXMuZWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LCB7XHJcbiAgICAgIGtleTogJ2RvU3luYycsXHJcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkb1N5bmMoZWxlbWVudCkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgZWxlbWVudCA9PT0gJ3VuZGVmaW5lZCcgfHwgZWxlbWVudCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGVsZW1lbnQubm9kZVR5cGUgIT09IDEpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50Tm9kZSB8fCBlbGVtZW50O1xyXG4gICAgICAgIHZhciBpdGVyYWJsZSA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicgKyB0aGlzLmNvbmZpZy5ib3hDbGFzcyk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVyYWJsZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgdmFyIGJveCA9IGl0ZXJhYmxlW2ldO1xyXG4gICAgICAgICAgaWYgKCFpc0luKGJveCwgdGhpcy5hbGwpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYm94ZXMucHVzaChib3gpO1xyXG4gICAgICAgICAgICB0aGlzLmFsbC5wdXNoKGJveCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN0b3BwZWQgfHwgdGhpcy5kaXNhYmxlZCgpKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5yZXNldFN0eWxlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5hcHBseVN0eWxlKGJveCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zY3JvbGxlZCA9IHRydWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LCB7XHJcbiAgICAgIGtleTogJ3Nob3cnLFxyXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdyhib3gpIHtcclxuICAgICAgICB0aGlzLmFwcGx5U3R5bGUoYm94KTtcclxuICAgICAgICBib3guY2xhc3NOYW1lID0gYm94LmNsYXNzTmFtZSArICcgJyArIHRoaXMuY29uZmlnLmFuaW1hdGVDbGFzcztcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuY2FsbGJhY2sgIT0gbnVsbCkge1xyXG4gICAgICAgICAgdGhpcy5jb25maWcuY2FsbGJhY2soYm94KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZW1pdEV2ZW50KGJveCwgdGhpcy53b3dFdmVudCk7XHJcblxyXG4gICAgICAgIGFkZEV2ZW50KGJveCwgJ2FuaW1hdGlvbmVuZCcsIHRoaXMucmVzZXRBbmltYXRpb24pO1xyXG4gICAgICAgIGFkZEV2ZW50KGJveCwgJ29hbmltYXRpb25lbmQnLCB0aGlzLnJlc2V0QW5pbWF0aW9uKTtcclxuICAgICAgICBhZGRFdmVudChib3gsICd3ZWJraXRBbmltYXRpb25FbmQnLCB0aGlzLnJlc2V0QW5pbWF0aW9uKTtcclxuICAgICAgICBhZGRFdmVudChib3gsICdNU0FuaW1hdGlvbkVuZCcsIHRoaXMucmVzZXRBbmltYXRpb24pO1xyXG5cclxuICAgICAgICByZXR1cm4gYm94O1xyXG4gICAgICB9XHJcbiAgICB9LCB7XHJcbiAgICAgIGtleTogJ2FwcGx5U3R5bGUnLFxyXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlTdHlsZShib3gsIGhpZGRlbikge1xyXG4gICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xyXG5cclxuICAgICAgICB2YXIgZHVyYXRpb24gPSBib3guZ2V0QXR0cmlidXRlKCdkYXRhLXdvdy1kdXJhdGlvbicpO1xyXG4gICAgICAgIHZhciBkZWxheSA9IGJveC5nZXRBdHRyaWJ1dGUoJ2RhdGEtd293LWRlbGF5Jyk7XHJcbiAgICAgICAgdmFyIGl0ZXJhdGlvbiA9IGJveC5nZXRBdHRyaWJ1dGUoJ2RhdGEtd293LWl0ZXJhdGlvbicpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5hbmltYXRlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHJldHVybiBfdGhpczIuY3VzdG9tU3R5bGUoYm94LCBoaWRkZW4sIGR1cmF0aW9uLCBkZWxheSwgaXRlcmF0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSwge1xyXG4gICAgICBrZXk6ICdyZXNldFN0eWxlJyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0U3R5bGUoKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmJveGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICB2YXIgYm94ID0gdGhpcy5ib3hlc1tpXTtcclxuICAgICAgICAgIGJveC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICB9XHJcbiAgICB9LCB7XHJcbiAgICAgIGtleTogJ3Jlc2V0QW5pbWF0aW9uJyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0QW5pbWF0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnR5cGUudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdhbmltYXRpb25lbmQnKSA+PSAwKSB7XHJcbiAgICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQ7XHJcbiAgICAgICAgICB0YXJnZXQuY2xhc3NOYW1lID0gdGFyZ2V0LmNsYXNzTmFtZS5yZXBsYWNlKHRoaXMuY29uZmlnLmFuaW1hdGVDbGFzcywgJycpLnRyaW0oKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0sIHtcclxuICAgICAga2V5OiAnY3VzdG9tU3R5bGUnLFxyXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gY3VzdG9tU3R5bGUoYm94LCBoaWRkZW4sIGR1cmF0aW9uLCBkZWxheSwgaXRlcmF0aW9uKSB7XHJcbiAgICAgICAgaWYgKGhpZGRlbikge1xyXG4gICAgICAgICAgdGhpcy5jYWNoZUFuaW1hdGlvbk5hbWUoYm94KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYm94LnN0eWxlLnZpc2liaWxpdHkgPSBoaWRkZW4gPyAnaGlkZGVuJyA6ICd2aXNpYmxlJztcclxuXHJcbiAgICAgICAgaWYgKGR1cmF0aW9uKSB7XHJcbiAgICAgICAgICB0aGlzLnZlbmRvclNldChib3guc3R5bGUsIHsgYW5pbWF0aW9uRHVyYXRpb246IGR1cmF0aW9uIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGVsYXkpIHtcclxuICAgICAgICAgIHRoaXMudmVuZG9yU2V0KGJveC5zdHlsZSwgeyBhbmltYXRpb25EZWxheTogZGVsYXkgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpdGVyYXRpb24pIHtcclxuICAgICAgICAgIHRoaXMudmVuZG9yU2V0KGJveC5zdHlsZSwgeyBhbmltYXRpb25JdGVyYXRpb25Db3VudDogaXRlcmF0aW9uIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnZlbmRvclNldChib3guc3R5bGUsIHsgYW5pbWF0aW9uTmFtZTogaGlkZGVuID8gJ25vbmUnIDogdGhpcy5jYWNoZWRBbmltYXRpb25OYW1lKGJveCkgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBib3g7XHJcbiAgICAgIH1cclxuICAgIH0sIHtcclxuICAgICAga2V5OiAndmVuZG9yU2V0JyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZlbmRvclNldChlbGVtLCBwcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBwcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgICBpZiAocHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBwcm9wZXJ0aWVzW25hbWVdO1xyXG4gICAgICAgICAgICBlbGVtWycnICsgbmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnZlbmRvcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICB2YXIgdmVuZG9yID0gdGhpcy52ZW5kb3JzW2ldO1xyXG4gICAgICAgICAgICAgIGVsZW1bJycgKyB2ZW5kb3IgKyBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zdWJzdHIoMSldID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0sIHtcclxuICAgICAga2V5OiAndmVuZG9yQ1NTJyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZlbmRvckNTUyhlbGVtLCBwcm9wZXJ0eSkge1xyXG4gICAgICAgIHZhciBzdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbSk7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHN0eWxlLmdldFByb3BlcnR5Q1NTVmFsdWUocHJvcGVydHkpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy52ZW5kb3JzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICB2YXIgdmVuZG9yID0gdGhpcy52ZW5kb3JzW2ldO1xyXG4gICAgICAgICAgcmVzdWx0ID0gcmVzdWx0IHx8IHN0eWxlLmdldFByb3BlcnR5Q1NTVmFsdWUoJy0nICsgdmVuZG9yICsgJy0nICsgcHJvcGVydHkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9XHJcbiAgICB9LCB7XHJcbiAgICAgIGtleTogJ2FuaW1hdGlvbk5hbWUnLFxyXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gYW5pbWF0aW9uTmFtZShib3gpIHtcclxuICAgICAgICB2YXIgYU5hbWUgPSB2b2lkIDA7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGFOYW1lID0gdGhpcy52ZW5kb3JDU1MoYm94LCAnYW5pbWF0aW9uLW5hbWUnKS5jc3NUZXh0O1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAvLyBPcGVyYSwgZmFsbCBiYWNrIHRvIHBsYWluIHByb3BlcnR5IHZhbHVlXHJcbiAgICAgICAgICBhTmFtZSA9IGdldENvbXB1dGVkU3R5bGUoYm94KS5nZXRQcm9wZXJ0eVZhbHVlKCdhbmltYXRpb24tbmFtZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGFOYW1lID09PSAnbm9uZScpIHtcclxuICAgICAgICAgIHJldHVybiAnJzsgLy8gU1ZHL0ZpcmVmb3gsIHVuYWJsZSB0byBnZXQgYW5pbWF0aW9uIG5hbWU/XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gYU5hbWU7XHJcbiAgICAgIH1cclxuICAgIH0sIHtcclxuICAgICAga2V5OiAnY2FjaGVBbmltYXRpb25OYW1lJyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNhY2hlQW5pbWF0aW9uTmFtZShib3gpIHtcclxuICAgICAgICAvLyBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD05MjE4MzRcclxuICAgICAgICAvLyBib3guZGF0YXNldCBpcyBub3Qgc3VwcG9ydGVkIGZvciBTVkcgZWxlbWVudHMgaW4gRmlyZWZveFxyXG4gICAgICAgIHJldHVybiB0aGlzLmFuaW1hdGlvbk5hbWVDYWNoZS5zZXQoYm94LCB0aGlzLmFuaW1hdGlvbk5hbWUoYm94KSk7XHJcbiAgICAgIH1cclxuICAgIH0sIHtcclxuICAgICAga2V5OiAnY2FjaGVkQW5pbWF0aW9uTmFtZScsXHJcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjYWNoZWRBbmltYXRpb25OYW1lKGJveCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFuaW1hdGlvbk5hbWVDYWNoZS5nZXQoYm94KTtcclxuICAgICAgfVxyXG4gICAgfSwge1xyXG4gICAgICBrZXk6ICdzY3JvbGxIYW5kbGVyJyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNjcm9sbEhhbmRsZXIoKSB7XHJcbiAgICAgICAgdGhpcy5zY3JvbGxlZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH0sIHtcclxuICAgICAga2V5OiAnc2Nyb2xsQ2FsbGJhY2snLFxyXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gc2Nyb2xsQ2FsbGJhY2soKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2Nyb2xsZWQpIHtcclxuICAgICAgICAgIHRoaXMuc2Nyb2xsZWQgPSBmYWxzZTtcclxuICAgICAgICAgIHZhciByZXN1bHRzID0gW107XHJcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYm94ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGJveCA9IHRoaXMuYm94ZXNbaV07XHJcbiAgICAgICAgICAgIGlmIChib3gpIHtcclxuICAgICAgICAgICAgICBpZiAodGhpcy5pc1Zpc2libGUoYm94KSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93KGJveCk7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKGJveCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMuYm94ZXMgPSByZXN1bHRzO1xyXG4gICAgICAgICAgaWYgKCF0aGlzLmJveGVzLmxlbmd0aCAmJiAhdGhpcy5jb25maWcubGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0sIHtcclxuICAgICAga2V5OiAnb2Zmc2V0VG9wJyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9mZnNldFRvcChlbGVtZW50KSB7XHJcbiAgICAgICAgLy8gU1ZHIGVsZW1lbnRzIGRvbid0IGhhdmUgYW4gb2Zmc2V0VG9wIGluIEZpcmVmb3guXHJcbiAgICAgICAgLy8gVGhpcyB3aWxsIHVzZSB0aGVpciBuZWFyZXN0IHBhcmVudCB0aGF0IGhhcyBhbiBvZmZzZXRUb3AuXHJcbiAgICAgICAgLy8gQWxzbywgdXNpbmcgKCdvZmZzZXRUb3AnIG9mIGVsZW1lbnQpIGNhdXNlcyBhbiBleGNlcHRpb24gaW4gRmlyZWZveC5cclxuICAgICAgICB3aGlsZSAoZWxlbWVudC5vZmZzZXRUb3AgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHRvcCA9IGVsZW1lbnQub2Zmc2V0VG9wO1xyXG4gICAgICAgIHdoaWxlIChlbGVtZW50Lm9mZnNldFBhcmVudCkge1xyXG4gICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQub2Zmc2V0UGFyZW50O1xyXG4gICAgICAgICAgdG9wICs9IGVsZW1lbnQub2Zmc2V0VG9wO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdG9wO1xyXG4gICAgICB9XHJcbiAgICB9LCB7XHJcbiAgICAgIGtleTogJ2lzVmlzaWJsZScsXHJcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1Zpc2libGUoYm94KSB7XHJcbiAgICAgICAgdmFyIG9mZnNldCA9IGJveC5nZXRBdHRyaWJ1dGUoJ2RhdGEtd293LW9mZnNldCcpIHx8IHRoaXMuY29uZmlnLm9mZnNldDtcclxuICAgICAgICB2YXIgdmlld1RvcCA9IHRoaXMuY29uZmlnLnNjcm9sbENvbnRhaW5lciAmJiB0aGlzLmNvbmZpZy5zY3JvbGxDb250YWluZXIuc2Nyb2xsVG9wIHx8IHdpbmRvdy5wYWdlWU9mZnNldDtcclxuICAgICAgICB2YXIgdmlld0JvdHRvbSA9IHZpZXdUb3AgKyBNYXRoLm1pbih0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0LCBnZXRJbm5lckhlaWdodCgpKSAtIG9mZnNldDtcclxuICAgICAgICB2YXIgdG9wID0gdGhpcy5vZmZzZXRUb3AoYm94KTtcclxuICAgICAgICB2YXIgYm90dG9tID0gdG9wICsgYm94LmNsaWVudEhlaWdodDtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRvcCA8PSB2aWV3Qm90dG9tICYmIGJvdHRvbSA+PSB2aWV3VG9wO1xyXG4gICAgICB9XHJcbiAgICB9LCB7XHJcbiAgICAgIGtleTogJ2Rpc2FibGVkJyxcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2FibGVkKCkge1xyXG4gICAgICAgIHJldHVybiAhdGhpcy5jb25maWcubW9iaWxlICYmIGlzTW9iaWxlKG5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XSk7XHJcblxyXG4gICAgcmV0dXJuIFdPVztcclxuICB9KCk7XHJcblxyXG4gIGV4cG9ydHMuZGVmYXVsdCA9IFdPVztcclxuICBtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcclxufSk7Il19
